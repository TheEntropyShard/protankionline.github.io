<!DOCTYPE html>

<html>
	<head>
		<title>test</title>
		
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />

		<!-- embed fonts -->
		
		
        <!-- engine code -->
		<script charset="UTF-8" src="js\flash\flash.js"></script>
		<script charset="UTF-8" src="js\flash\accessibility\Accessibility.js"></script>
		<script charset="UTF-8" src="js\flash\accessibility\AccessibilityImplementation.js"></script>
		<script charset="UTF-8" src="js\flash\accessibility\AccessibilityProperties.js"></script>
		<script charset="UTF-8" src="js\flash\display\ActionScriptVersion.js"></script>
		<script charset="UTF-8" src="js\flash\display\AVM1Movie.js"></script>
		<script charset="UTF-8" src="js\flash\display\Bitmap.js"></script>
		<script charset="UTF-8" src="js\flash\display\BitmapData.js"></script>
		<script charset="UTF-8" src="js\flash\display\BitmapDataChannel.js"></script>
		<script charset="UTF-8" src="js\flash\display\BlendMode.js"></script>
		<script charset="UTF-8" src="js\flash\display\CapsStyle.js"></script>
		<script charset="UTF-8" src="js\flash\display\DisplayObject.js"></script>
		<script charset="UTF-8" src="js\flash\display\DisplayObjectContainer.js"></script>
		<script charset="UTF-8" src="js\flash\display\FrameLabel.js"></script>
		<script charset="UTF-8" src="js\flash\display\GradientType.js"></script>
		<script charset="UTF-8" src="js\flash\display\Graphics.js"></script>
		<script charset="UTF-8" src="js\flash\display\GraphicsBitmapFill.js"></script>
		<script charset="UTF-8" src="js\flash\display\GraphicsEndFill.js"></script>
		<script charset="UTF-8" src="js\flash\display\GraphicsGradientFill.js"></script>
		<script charset="UTF-8" src="js\flash\display\GraphicsPath.js"></script>
		<script charset="UTF-8" src="js\flash\display\GraphicsPathCommand.js"></script>
		<script charset="UTF-8" src="js\flash\display\GraphicsPathWinding.js"></script>
		<script charset="UTF-8" src="js\flash\display\GraphicsSolidFill.js"></script>
		<script charset="UTF-8" src="js\flash\display\GraphicsStroke.js"></script>
		<script charset="UTF-8" src="js\flash\display\IBitmapDrawable.js"></script>
		<script charset="UTF-8" src="js\flash\display\IGraphicsData.js"></script>
		<script charset="UTF-8" src="js\flash\display\IGraphicsFill.js"></script>
		<script charset="UTF-8" src="js\flash\display\IGraphicsPath.js"></script>
		<script charset="UTF-8" src="js\flash\display\IGraphicsStroke.js"></script>
		<script charset="UTF-8" src="js\flash\display\InteractiveObject.js"></script>
		<script charset="UTF-8" src="js\flash\display\InterpolationMethod.js"></script>
		<script charset="UTF-8" src="js\flash\display\JointStyle.js"></script>
		<script charset="UTF-8" src="js\flash\display\LineScaleMode.js"></script>
		<script charset="UTF-8" src="js\flash\display\Loader.js"></script>
		<script charset="UTF-8" src="js\flash\display\LoaderInfo.js"></script>
		<script charset="UTF-8" src="js\flash\display\MorphShape.js"></script>
		<script charset="UTF-8" src="js\flash\display\MovieClip.js"></script>
		<script charset="UTF-8" src="js\flash\display\PixelSnapping.js"></script>
		<script charset="UTF-8" src="js\flash\display\Render2d.js"></script>
		<script charset="UTF-8" src="js\flash\display\Render3d.js"></script>
		<script charset="UTF-8" src="js\flash\display\Scene.js"></script>
		<script charset="UTF-8" src="js\flash\display\Shape.js"></script>
		<script charset="UTF-8" src="js\flash\display\SimpleButton.js"></script>
		<script charset="UTF-8" src="js\flash\display\SpreadMethod.js"></script>
		<script charset="UTF-8" src="js\flash\display\Sprite.js"></script>
		<script charset="UTF-8" src="js\flash\display\Stage.js"></script>
		<script charset="UTF-8" src="js\flash\display\StageAlign.js"></script>
		<script charset="UTF-8" src="js\flash\display\StageDisplayState.js"></script>
		<script charset="UTF-8" src="js\flash\display\StageQuality.js"></script>
		<script charset="UTF-8" src="js\flash\display\StageScaleMode.js"></script>
		<script charset="UTF-8" src="js\flash\display\SWFVersion.js"></script>
		<script charset="UTF-8" src="js\flash\errors\EOFError.js"></script>
		<script charset="UTF-8" src="js\flash\errors\IllegalOperationError.js"></script>
		<script charset="UTF-8" src="js\flash\errors\InvalidSWFError.js"></script>
		<script charset="UTF-8" src="js\flash\errors\IOError.js"></script>
		<script charset="UTF-8" src="js\flash\errors\MemoryError.js"></script>
		<script charset="UTF-8" src="js\flash\errors\ScriptTimeoutError.js"></script>
		<script charset="UTF-8" src="js\flash\errors\StackOverflowError.js"></script>
		<script charset="UTF-8" src="js\flash\events\ActivityEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\AsyncErrorEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\ContextMenuEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\DataEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\ErrorEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\Event.js"></script>
		<script charset="UTF-8" src="js\flash\events\EventDispatcher.js"></script>
		<script charset="UTF-8" src="js\flash\events\EventPhase.js"></script>
		<script charset="UTF-8" src="js\flash\events\FocusEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\FullScreenEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\HTTPStatusEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\IEventDispatcher.js"></script>
		<script charset="UTF-8" src="js\flash\events\IMEEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\IOErrorEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\KeyboardEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\MouseEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\NetFilterEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\NetStatusEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\ProgressEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\SecurityErrorEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\StatusEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\SyncEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\TextEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\TimerEvent.js"></script>
		<script charset="UTF-8" src="js\flash\events\TouchEvent.js"></script>
		<script charset="UTF-8" src="js\flash\external\ExternalInterface.js"></script>
		<script charset="UTF-8" src="js\flash\filters\BevelFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\BitmapFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\BitmapFilterQuality.js"></script>
		<script charset="UTF-8" src="js\flash\filters\BitmapFilterType.js"></script>
		<script charset="UTF-8" src="js\flash\filters\BlurFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\ColorMatrixFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\ConvolutionFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\DisplacementMapFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\DisplacementMapFilterMode.js"></script>
		<script charset="UTF-8" src="js\flash\filters\DropShadowFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\GlowFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\GradientBevelFilter.js"></script>
		<script charset="UTF-8" src="js\flash\filters\GradientGlowFilter.js"></script>
		<script charset="UTF-8" src="js\flash\geom\ColorTransform.js"></script>
		<script charset="UTF-8" src="js\flash\geom\Matrix.js"></script>
		<script charset="UTF-8" src="js\flash\geom\Matrix3D.js"></script>
		<script charset="UTF-8" src="js\flash\geom\Point.js"></script>
		<script charset="UTF-8" src="js\flash\geom\Rectangle.js"></script>
		<script charset="UTF-8" src="js\flash\geom\Transform.js"></script>
		<script charset="UTF-8" src="js\flash\geom\Vector3D.js"></script>
		<script charset="UTF-8" src="js\flash\media\Camera.js"></script>
		<script charset="UTF-8" src="js\flash\media\ID3Info.js"></script>
		<script charset="UTF-8" src="js\flash\media\Microphone.js"></script>
		<script charset="UTF-8" src="js\flash\media\Sound.js"></script>
		<script charset="UTF-8" src="js\flash\media\SoundChannel.js"></script>
		<script charset="UTF-8" src="js\flash\media\SoundLoaderContext.js"></script>
		<script charset="UTF-8" src="js\flash\media\SoundMixer.js"></script>
		<script charset="UTF-8" src="js\flash\media\SoundTransform.js"></script>
		<script charset="UTF-8" src="js\flash\media\Video.js"></script>
		<script charset="UTF-8" src="js\flash\net\FileFilter.js"></script>
		<script charset="UTF-8" src="js\flash\net\FileReference.js"></script>
		<script charset="UTF-8" src="js\flash\net\FileReferenceList.js"></script>
		<script charset="UTF-8" src="js\flash\net\LocalConnection.js"></script>
		<script charset="UTF-8" src="js\flash\net\net.js"></script>
		<script charset="UTF-8" src="js\flash\net\NetConnection.js"></script>
		<script charset="UTF-8" src="js\flash\net\NetStream.js"></script>
		<script charset="UTF-8" src="js\flash\net\ObjectEncoding.js"></script>
		<script charset="UTF-8" src="js\flash\net\Responder.js"></script>
		<script charset="UTF-8" src="js\flash\net\SharedObject.js"></script>
		<script charset="UTF-8" src="js\flash\net\SharedObjectFlushStatus.js"></script>
		<script charset="UTF-8" src="js\flash\net\Socket.js"></script>
		<script charset="UTF-8" src="js\flash\net\URLLoader.js"></script>
		<script charset="UTF-8" src="js\flash\net\URLLoaderDataFormat.js"></script>
		<script charset="UTF-8" src="js\flash\net\URLRequest.js"></script>
		<script charset="UTF-8" src="js\flash\net\URLRequestHeader.js"></script>
		<script charset="UTF-8" src="js\flash\net\URLRequestMethod.js"></script>
		<script charset="UTF-8" src="js\flash\net\URLStream.js"></script>
		<script charset="UTF-8" src="js\flash\net\URLVariables.js"></script>
		<script charset="UTF-8" src="js\flash\net\XMLSocket.js"></script>
		<script charset="UTF-8" src="js\flash\printing\PrintJob.js"></script>
		<script charset="UTF-8" src="js\flash\printing\PrintJobOptions.js"></script>
		<script charset="UTF-8" src="js\flash\printing\PrintJobOrientation.js"></script>
		<script charset="UTF-8" src="js\flash\sampler\DeleteObjectSample.js"></script>
		<script charset="UTF-8" src="js\flash\sampler\NewObjectSample.js"></script>
		<script charset="UTF-8" src="js\flash\sampler\Sample.js"></script>
		<script charset="UTF-8" src="js\flash\sampler\StackFrame.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineBinaryData.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineBits.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineButton.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineEditText.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineFont.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineScene.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineShape.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineSound.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineSprite.js"></script>
		<script charset="UTF-8" src="js\flash\swf\DefineText.js"></script>
		<script charset="UTF-8" src="js\flash\swf\End.js"></script>
		<script charset="UTF-8" src="js\flash\swf\FrameLabel.js"></script>
		<script charset="UTF-8" src="js\flash\swf\PlaceObject.js"></script>
		<script charset="UTF-8" src="js\flash\swf\RemoveObject.js"></script>
		<script charset="UTF-8" src="js\flash\swf\ShowFrame.js"></script>
		<script charset="UTF-8" src="js\flash\swf\SymbolClass.js"></script>
		<script charset="UTF-8" src="js\flash\swf\Tag.js"></script>
		<script charset="UTF-8" src="js\flash\system\ApplicationDomain.js"></script>
		<script charset="UTF-8" src="js\flash\system\Capabilities.js"></script>
		<script charset="UTF-8" src="js\flash\system\FSCommand.js"></script>
		<script charset="UTF-8" src="js\flash\system\IME.js"></script>
		<script charset="UTF-8" src="js\flash\system\IMEConversionMode.js"></script>
		<script charset="UTF-8" src="js\flash\system\LoaderContext.js"></script>
		<script charset="UTF-8" src="js\flash\system\Security.js"></script>
		<script charset="UTF-8" src="js\flash\system\SecurityDomain.js"></script>
		<script charset="UTF-8" src="js\flash\system\SecurityPanel.js"></script>
		<script charset="UTF-8" src="js\flash\system\System.js"></script>
		<script charset="UTF-8" src="js\flash\text\AntiAliasType.js"></script>
		<script charset="UTF-8" src="js\flash\text\CSMSettings.js"></script>
		<script charset="UTF-8" src="js\flash\text\CSSFontLoader.js"></script>
		<script charset="UTF-8" src="js\flash\text\Font.js"></script>
		<script charset="UTF-8" src="js\flash\text\FontStyle.js"></script>
		<script charset="UTF-8" src="js\flash\text\FontType.js"></script>
		<script charset="UTF-8" src="js\flash\text\GridFitType.js"></script>
		<script charset="UTF-8" src="js\flash\text\StaticText.js"></script>
		<script charset="UTF-8" src="js\flash\text\StyleSheet.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextColorType.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextDisplayMode.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextExtent.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextField.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextFieldAutoSize.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextFieldType.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextFormat.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextFormatAlign.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextFormatDisplay.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextLineMetrics.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextRenderer.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextRun.js"></script>
		<script charset="UTF-8" src="js\flash\text\TextSnapshot.js"></script>
		<script charset="UTF-8" src="js\flash\ui\ContextMenu.js"></script>
		<script charset="UTF-8" src="js\flash\ui\ContextMenuBuiltInItems.js"></script>
		<script charset="UTF-8" src="js\flash\ui\ContextMenuItem.js"></script>
		<script charset="UTF-8" src="js\flash\ui\Keyboard.js"></script>
		<script charset="UTF-8" src="js\flash\ui\KeyLocation.js"></script>
		<script charset="UTF-8" src="js\flash\ui\Mouse.js"></script>
		<script charset="UTF-8" src="js\flash\utils\ByteArray.js"></script>
		<script charset="UTF-8" src="js\flash\utils\Dictionary.js"></script>
		<script charset="UTF-8" src="js\flash\utils\Endian.js"></script>
		<script charset="UTF-8" src="js\flash\utils\IDataInput.js"></script>
		<script charset="UTF-8" src="js\flash\utils\IDataOutput.js"></script>
		<script charset="UTF-8" src="js\flash\utils\Timer.js"></script>
		<script charset="UTF-8" src="js\flash\utils\utils.js"></script>
		<script charset="UTF-8" src="js\flash\xml\XMLDocument.js"></script>
		<script charset="UTF-8" src="js\flash\xml\XMLNode.js"></script>
		<script charset="UTF-8" src="js\flash\xml\XMLNodeType.js"></script>
		<script charset="UTF-8" src="js\flash\XML.js"></script>
		<script charset="UTF-8" src="js\flash\XMLList.js"></script>
		
		<!-- application code -->
		
		
	</head>
	
	<body bgcolor="#ffffff" style="margin:0; padding:0; overflow: hidden;">
		
		<div id="flashContainer">
			<canvas id="flashCanvas" width="640" height="480" style="background-color:#ffffff;"></canvas>
		</div>

		<script>
			
			//parameters
			var mode = "auto";
			var fps = 30;
			var scale = "showAll";
			var align = "";
			var fill = true;
			var debug = true;

			var flashVars = {};
			
			if (window.location.href.indexOf("?") != -1)
			{
				var parameters = window.location.href.split("?")[1].split("&");
				
				for (var i in parameters)
				{
					var parameter = parameters[i];
					
					var parts = parameter.split("=");
					
					if (parts.length == 2)
					{
						var parameterName = parts[0];
						var parameterValue = parts[1];
						
						flashVars[parameterName] = parameterValue;

						if (parameterName == "mode")
						{
							mode = parameterValue;
						}
						
						if (parameterName == "fps")
						{
							fps = Number(parameterValue);
						}

						if (parameterName == "scale")
						{
						    scale = parameterValue;
						}
						
						if (parameterName == "align")
						{
						    align = parameterValue;
						}

						if (parameterName == "back")
						{
						    back = parameterValue;
						}
					}
				}
			}

			flash.init();
			
			if (!debug)
			{
				flash.trace = function () { };
			}

			var originalWidth = 640;
			var originalHeight = 480;
			
			var stage = new flash.display.Stage('flashCanvas', mode, originalWidth, originalHeight);
			stage.set_frameRate(fps);
			stage.set_scaleMode(scale);
			stage.set_align(align);
			stage.set_color(0xffffff);
			stage.get_loaderInfo().set_parameters(flashVars);
			
			var preloader = new flash.display.Loader();
			preloader.get_contentLoaderInfo().addEventListener(flash.events.Event.COMPLETE, preloadComplete);
			preloader.load(new flash.net.URLRequest("data/preloader.xml"));
			
			var loader = new flash.display.Loader();
			loader.get_contentLoaderInfo().addEventListener(flash.events.Event.COMPLETE, loadComplete);
			
			function preloadComplete(e)
			{
				preloader.get_contentLoaderInfo().removeEventListener(flash.events.Event.COMPLETE, preloadComplete);
				
				stage.addChild(preloader.get_content());

				updatePreloader();

				loader.load(new flash.net.URLRequest("data/test.xml"));
			}
			
			function loadComplete(e)
			{
			    stage.removeChild(preloader.get_content());
				
				loader.get_contentLoaderInfo().removeEventListener(flash.events.Event.COMPLETE, loadComplete);
				
				console.log("loadComplete");
				console.log("loader.content = " + loader.get_content());

				stage.addChild(loader.get_content());
			}

			function onWindowResize()
			{
			    flash.minimize();

				var windowWidth = window.innerWidth;
				var windowHeight = window.innerHeight;
				
				var scale = Math.min(windowWidth / originalWidth, windowHeight / originalHeight);
				
				var resultWidth = fill ? windowWidth : Math.floor(originalWidth * scale);
				var resultHeight = fill ? windowHeight : Math.floor(originalHeight * scale);
				
				if (stage)
				{
					stage.updateSize(resultWidth, resultHeight);
				}
				else
				{
					var canvas = document.getElementById("flashCanvas");
					canvas.width = resultWidth;
					canvas.height = resultHeight;
				}
				
				var container = document.getElementById("flashContainer");
				container.style.position = "absolute";
				container.style.left = "0px";
				container.style.top = "0px";
				
				updatePreloader();
			}

			function updatePreloader()
			{
			    if (preloader)
			    {
			        var content = preloader.get_content();

			        if (content && content instanceof flash.display.DisplayObject)
			        {
			            content.set_x((stage.get_stageWidth() - preloader.get_contentLoaderInfo().get_width()) / 2);
			            content.set_y((stage.get_stageHeight() - preloader.get_contentLoaderInfo().get_height()) / 2);
			        }
			    }
			}
			
			window.addEventListener("resize", onWindowResize);
			
			onWindowResize();
		</script>
	</body>
</html>
